import{v as Q,w as G,x as T,V as j,_ as w,bE as W,bF as _,bG as H,bH as X,r as u,y as J,z as q,j as a,E as V,H as Y,a as D,C as R,aK as Z,bI as ee,bJ as ae,s as o,bB as te,aL as re,bK as se,d as oe,bL as ie,A as ne,k as le,G as n,B as O,bM as ce,bN as de,bO as pe,h as A}from"./index-a584ef0b.js";import{aE as Ie,aJ as Re,aQ as ze,b_ as Ue,c0 as Ke,b5 as Le,b$ as Be,bP as Qe,aF as Ge,aI as We,aP as He,c1 as Xe,c3 as Je,b6 as qe,c2 as Ve,bQ as Ye,aG as Ze,aH as ea,c4 as aa,c5 as ta,aZ as ra,ax as sa,aB as oa,bR as ia,aC as na,a7 as la,bA as ca,aM as da,aS as pa,bW as ua,bX as ha,bS as ma,aA as ga,ap as xa,bV as fa,P as ba,bT as va,bU as ya,ay as Sa,bY as ja,aN as wa,c8 as Ca,au as Aa,c6 as ka,c7 as Pa,bZ as Da,ak as Ta,ac as Ea,t as $a}from"./index-a584ef0b.js";import{C as Na,a as Fa}from"./CollectorCardList-5ce66dbe.js";import{C as Oa}from"./ConfirmationDialog-e2da8cb5.js";import{C as Ra}from"./ContentPage-b5dcd0a0.js";import{C as Ua,a as Ka,S as La}from"./SAMLProviderTable-3e695f94.js";import{D as Qa}from"./DataTable-38a000d7.js";import{D as ue}from"./Disable2FADialog-53f5f996.js";import{b as Wa,F as Ha,d as Xa,e as Ja,c as qa,a as Va}from"./FinishedIngestLog-6e60ddd6.js";import{A as Za,E as et,G as at,H as tt,g as rt,N as st,d as ot,a as it,P as nt,S as lt,c as ct,j as dt,k as pt,n as ut,e as ht,f as mt,o as gt,q as xt,t as ft,p as bt,r as vt,i as yt,s as St,u as jt,m as wt,h as Ct,l as At}from"./SearchCurrentNodes-14ba0c11.js";import{O as Pt}from"./OneTimePasscodeForm-3ebdc5c0.js";import{P as E}from"./PageWithTitle-96a4a919.js";import{u as Tt}from"./useAvailableDomains-f6141468.js";import"./TableContainer-2d43236c.js";import"./KeyboardArrowRight-6e82a04f.js";import"./ListSubheader-88606394.js";import"./tslib.es6-ed841dd2.js";function he(e){return G("MuiSwitch",e)}const me=Q("MuiSwitch",["root","edgeStart","edgeEnd","switchBase","colorPrimary","colorSecondary","sizeSmall","sizeMedium","checked","disabled","input","thumb","track"]),c=me,ge=["className","color","edge","size","sx"],xe=e=>{const{classes:s,edge:t,size:r,color:i,checked:v,disabled:m}=e,x={root:["root",t&&`edge${j(t)}`,`size${j(r)}`],switchBase:["switchBase",`color${j(i)}`,v&&"checked",m&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},d=Y(x,he,s);return w({},s,d)},fe=T("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(e,s)=>{const{ownerState:t}=e;return[s.root,t.edge&&s[`edge${j(t.edge)}`],s[`size${j(t.size)}`]]}})(({ownerState:e})=>w({display:"inline-flex",width:34+12*2,height:14+12*2,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"}},e.edge==="start"&&{marginLeft:-8},e.edge==="end"&&{marginRight:-8},e.size==="small"&&{width:40,height:24,padding:7,[`& .${c.thumb}`]:{width:16,height:16},[`& .${c.switchBase}`]:{padding:4,[`&.${c.checked}`]:{transform:"translateX(16px)"}}})),be=T(W,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(e,s)=>{const{ownerState:t}=e;return[s.switchBase,{[`& .${c.input}`]:s.input},t.color!=="default"&&s[`color${j(t.color)}`]]}})(({theme:e})=>({position:"absolute",top:0,left:0,zIndex:1,color:e.vars?e.vars.palette.Switch.defaultColor:`${e.palette.mode==="light"?e.palette.common.white:e.palette.grey[300]}`,transition:e.transitions.create(["left","transform"],{duration:e.transitions.duration.shortest}),[`&.${c.checked}`]:{transform:"translateX(20px)"},[`&.${c.disabled}`]:{color:e.vars?e.vars.palette.Switch.defaultDisabledColor:`${e.palette.mode==="light"?e.palette.grey[100]:e.palette.grey[600]}`},[`&.${c.checked} + .${c.track}`]:{opacity:.5},[`&.${c.disabled} + .${c.track}`]:{opacity:e.vars?e.vars.opacity.switchTrackDisabled:`${e.palette.mode==="light"?.12:.2}`},[`& .${c.input}`]:{left:"-100%",width:"300%"}}),({theme:e,ownerState:s})=>w({"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:_(e.palette.action.active,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},s.color!=="default"&&{[`&.${c.checked}`]:{color:(e.vars||e).palette[s.color].main,"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette[s.color].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:_(e.palette[s.color].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${c.disabled}`]:{color:e.vars?e.vars.palette.Switch[`${s.color}DisabledColor`]:`${e.palette.mode==="light"?H(e.palette[s.color].main,.62):X(e.palette[s.color].main,.55)}`}},[`&.${c.checked} + .${c.track}`]:{backgroundColor:(e.vars||e).palette[s.color].main}})),ve=T("span",{name:"MuiSwitch",slot:"Track",overridesResolver:(e,s)=>s.track})(({theme:e})=>({height:"100%",width:"100%",borderRadius:14/2,zIndex:-1,transition:e.transitions.create(["opacity","background-color"],{duration:e.transitions.duration.shortest}),backgroundColor:e.vars?e.vars.palette.common.onBackground:`${e.palette.mode==="light"?e.palette.common.black:e.palette.common.white}`,opacity:e.vars?e.vars.opacity.switchTrack:`${e.palette.mode==="light"?.38:.3}`})),ye=T("span",{name:"MuiSwitch",slot:"Thumb",overridesResolver:(e,s)=>s.thumb})(({theme:e})=>({boxShadow:(e.vars||e).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"})),Se=u.forwardRef(function(s,t){const r=J({props:s,name:"MuiSwitch"}),{className:i,color:v="primary",edge:m=!1,size:x="medium",sx:d}=r,S=q(r,ge),h=w({},r,{color:v,edge:m,size:x}),y=xe(h),k=a.jsx(ye,{className:y.thumb,ownerState:h});return a.jsxs(fe,{className:V(y.root,i),sx:d,ownerState:h,children:[a.jsx(be,w({type:"checkbox",icon:k,checkedIcon:k,ref:t,ownerState:h},S,{classes:w({},y,{root:y.switchBase})})),a.jsx(ve,{className:y.track,ownerState:h})]})}),je=Se,Me=({loading:e})=>e?a.jsx(D,{position:"absolute",top:"0",left:"0",right:"0",bottom:"0",bgcolor:"rgba(0, 0, 0, 0.2)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,children:a.jsx(R,{color:"primary"})}):null,we=e=>{if(e!=null&&e.first_name&&(e!=null&&e.last_name))return`${e.first_name} ${e.last_name}`;if(e!=null&&e.first_name)return e.first_name;if(e!=null&&e.principal_name)return e.principal_name},Ce=e=>({h1:({children:t})=>a.jsx(o,{variant:"h1",style:{margin:"1rem 0"},children:t}),h2:({children:t})=>a.jsx(o,{variant:"h2",style:{margin:"1rem 0"},children:t}),h3:({children:t})=>a.jsx(o,{variant:"h3",style:{margin:"1rem 0"},children:t}),h4:({children:t})=>a.jsx(o,{variant:"h4",style:{margin:"1rem 0"},children:t}),h5:({children:t})=>a.jsx(o,{variant:"h5",style:{margin:"1rem 0"},children:t}),h6:({children:t})=>a.jsx(o,{variant:"h6",style:{margin:"1rem 0"},children:t}),a:({node:t,...r})=>a.jsx(te,{to:"#",color:"primary",target:"_blank",rel:"noopener noreferrer",...r}),blockquote:({node:t,...r})=>a.jsx("blockquote",{style:{margin:"1rem 0"},...r}),code:({node:t,inline:r,...i})=>a.jsx("code",{component:"code",style:{backgroundColor:"#e1e1e1",borderRadius:"4px",padding:r?"0 0.25em":"0"},...i}),em:({node:t,...r})=>a.jsx("em",{...r}),hr:({node:t,...r})=>a.jsx(re,{...r}),img:({node:t,...r})=>{const i=e?`${e}${r.src}`:r.src;return a.jsx("img",{...r,alt:r.alt,src:i,style:{maxWidth:"100%"}})},li:({node:t,ordered:r,...i})=>a.jsx("li",{...i}),ol:({node:t,ordered:r,...i})=>a.jsx("ol",{style:{paddingLeft:"1em",marginBottom:"1em"},...i}),p:({node:t,...r})=>a.jsx("p",{style:{margin:"1rem 0"},...r}),pre:({node:t,...r})=>a.jsx("pre",{style:{fontSize:"0.875rem",backgroundColor:"#e1e1e1",padding:"1rem",borderRadius:"4px",overflow:"auto",margin:"1rem 0"},...r}),strong:({node:t,...r})=>a.jsx("strong",{...r}),ul:({node:t,ordered:r,...i})=>a.jsx("ul",{style:{paddingLeft:"1em",marginBottom:"1em"},...i})}),Ne=({url:e,baseURL:s,markdown:t=!1,fallback:r="An error has occurred."})=>{const[i,v]=u.useState(!1),[m,x]=u.useState(void 0),[d,S]=u.useState(void 0);return u.useEffect(()=>{v(!0),x(""),fetch(e).then(h=>h.text()).then(h=>{S(h),x("")}).catch(h=>{S(void 0),x(h)}).finally(()=>{v(!1)})},[e]),i?a.jsx(Z,{}):m||(d==null?void 0:d.charAt(0))==="<"?a.jsx("p",{style:{margin:"1rem 0"},children:r}):t?a.jsx(ee,{components:Ce(s),children:d}):a.jsx("div",{children:ae.sanitize(d)})},I=({text:e,fallback:s})=>typeof e!="string"||e.trim()===""?a.jsx("em",{children:s}):a.jsx(a.Fragment,{children:e}),Fe=()=>{var $,M,N,F;const{addNotification:e}=se(),[s,t]=u.useState(!1),[r,i]=u.useState(!1),[v,m]=u.useState(!1),[x,d]=u.useState(!1),[S,h]=u.useState(""),[y,k]=u.useState(""),[z,f]=u.useState(""),[U,C]=u.useState(""),[K,P]=u.useState(""),b=oe(["getSelf"],({signal:p})=>A.getSelf({signal:p}).then(g=>g.data.data)),L=ie(({userId:p,secret:g,needsPasswordReset:B})=>A.putUserAuthSecret(p,{needs_password_reset:B,secret:g}),{onSuccess:()=>{e("Password updated successfully!","updateUserPasswordSuccess"),t(!1)}});if(b.isLoading)return a.jsxs(E,{title:"My Profile","data-testid":"my-profile",children:[a.jsx(o,{variant:"h2",children:"User Information"}),a.jsx(D,{p:4,textAlign:"center",children:a.jsx(R,{})})]});if(b.isError)return a.jsxs(E,{title:"My Profile","data-testid":"my-profile",children:[a.jsx(o,{variant:"h2",children:"User Information"}),a.jsxs(ne,{severity:"error",children:[a.jsx(le,{children:"Error"}),"Sorry, there was a problem fetching your user information.",a.jsx("br",{}),"Please try refreshing the page or logging in again."]})]});const l=b.data;return a.jsxs(a.Fragment,{children:[a.jsxs(E,{title:"My Profile","data-testid":"my-profile",children:[a.jsx(o,{variant:"h2",children:"User Information"}),a.jsxs(n,{container:!0,spacing:2,alignItems:"center",children:[a.jsx(n,{item:!0,xs:3,children:a.jsx(o,{variant:"body1",children:"Email"})}),a.jsx(n,{item:!0,xs:9,children:a.jsx(o,{variant:"body1",children:l==null?void 0:l.email_address})}),a.jsx(n,{item:!0,xs:3,children:a.jsx(o,{variant:"body1",children:"Name"})}),a.jsx(n,{item:!0,xs:9,children:a.jsx(o,{variant:"body1",children:a.jsx(I,{text:we(l),fallback:"Unknown"})})}),a.jsx(n,{item:!0,xs:3,children:a.jsx(o,{variant:"body1",children:"Role"})}),a.jsx(n,{item:!0,xs:9,children:a.jsx(o,{variant:"body1",children:a.jsx(I,{text:(M=($=l==null?void 0:l.roles)==null?void 0:$[0])==null?void 0:M.name,fallback:"Unknown"})})})]}),a.jsx(D,{mt:2,children:a.jsx(o,{variant:"h2",children:"Authentication"})}),a.jsxs(n,{container:!0,spacing:2,alignItems:"center",children:[a.jsxs(n,{container:!0,item:!0,children:[a.jsx(n,{item:!0,xs:3,children:a.jsx(o,{variant:"body1",children:"API Key Management"})}),a.jsx(n,{item:!0,xs:2,children:a.jsx(O,{variant:"contained",color:"primary",size:"small",disableElevation:!0,fullWidth:!0,onClick:()=>i(!0),"data-testid":"my-profile_button-api-key-management",children:"API Key Management"})})]}),l.saml_provider_id===null&&a.jsxs(a.Fragment,{children:[a.jsxs(n,{container:!0,item:!0,children:[a.jsx(n,{item:!0,xs:3,children:a.jsx(o,{variant:"body1",children:"Password"})}),a.jsx(n,{item:!0,xs:2,children:a.jsx(O,{variant:"contained",color:"primary",size:"small",disableElevation:!0,fullWidth:!0,onClick:()=>t(!0),"data-testid":"my-profile_button-reset-password",children:"Reset Password"})})]}),a.jsxs(n,{container:!0,item:!0,children:[a.jsx(n,{item:!0,xs:3,children:a.jsx(o,{variant:"body1",children:"Multi-Factor Authentication"})}),a.jsx(n,{item:!0,xs:9,children:a.jsxs(D,{display:"flex",alignItems:"center",children:[a.jsx(je,{inputProps:{"aria-label":"Multi-Factor Authentication Enabled"},checked:(N=l.AuthSecret)==null?void 0:N.totp_activated,onChange:()=>{var p;(p=l.AuthSecret)!=null&&p.totp_activated?d(!0):m(!0)},color:"primary","data-testid":"my-profile_switch-multi-factor-authentication"}),((F=l.AuthSecret)==null?void 0:F.totp_activated)&&a.jsx(o,{variant:"body1",children:"Enabled"})]})})]})]})]})]}),a.jsx(ce,{open:s,onClose:()=>t(!1),userId:l.id,showNeedsPasswordReset:!1,onSave:L.mutate}),a.jsx(de,{open:r,onClose:()=>i(!1),userId:l.id}),a.jsx(pe,{open:v,onClose:()=>{m(!1),f(""),P(""),b.refetch()},onCancel:()=>{m(!1),f(""),P(""),b.refetch()},onSavePassword:p=>(f(""),A.enrollMFA(l.id,{secret:p}).then(g=>{k(g.data.data.qr_code),h(g.data.data.totp_secret),f("")}).catch(g=>{throw f("Unable to verify password. Please try again."),g})),onSaveOTP:p=>(f(""),A.activateMFA(l.id,{otp:p}).then(()=>{f("")}).catch(g=>{throw f("Unable to verify one-time password. Please try again."),g})),onSave:()=>{m(!1),f(""),b.refetch()},TOTPSecret:S,QRCode:y,error:z}),a.jsx(ue,{open:x,onClose:()=>{d(!1),C(""),b.refetch()},onCancel:()=>{d(!1),C(""),b.refetch()},onSave:p=>{C(""),A.disenrollMFA(l.id,{secret:p}).then(()=>{d(!1),C(""),P(""),b.refetch()}).catch(()=>{C("Unable to verify password. Please try again.")})},error:U,secret:K,onSecretChange:p=>P(p.target.value),contentText:"To stop using multi-factor authentication, please enter your password for security purposes."})]})};export{Za as ADSpecificTimeProperties,Ie as ActiveDirectoryKindProperties,Re as ActiveDirectoryKindPropertiesToDisplay,ze as ActiveDirectoryNodeKind,Ue as ActiveDirectoryNodeKindToDisplay,Ke as ActiveDirectoryPathfindingEdges,Le as ActiveDirectoryRelationshipKind,Be as ActiveDirectoryRelationshipKindToDisplay,Qe as AppNotifications,Ge as AzureKindProperties,We as AzureKindPropertiesToDisplay,He as AzureNodeKind,Xe as AzureNodeKindToDisplay,Je as AzurePathfindingEdges,qe as AzureRelationshipKind,Ve as AzureRelationshipKindToDisplay,Ye as CheckboxGroup,Na as CollectorCard,Fa as CollectorCardList,Ze as CommonKindProperties,ea as CommonKindPropertiesToDisplay,aa as CommonNodeKind,ta as CommonNodeKindToDisplay,ra as CommonSearches,Oa as ConfirmationDialog,Ra as ContentPage,Ua as CreateSAMLProviderDialog,Ka as CreateSAMLProviderForm,Qa as DataTable,ue as Disable2FADialog,et as EdgeInfoComponents,sa as EdgeSections,pe as Enable2FADialog,Wa as FileStatus,Ha as FileUploadDialog,Xa as FileUploadJobStatus,Ja as FileUploadJobStatusToString,qa as FileUploadStep,Va as FinishedIngestLog,oa as GLYPHS,ia as GenericErrorBoundaryFallback,na as GlyphKind,la as GraphButton,at as GraphMenu,ca as GraphProgress,tt as HighlightedText,da as Icon,pa as InfiniteScrollingTable,ua as LUXON_DATETIME_REGEX,Me as LoadingOverlay,ha as LuxonFormat,ma as MenuItem,ga as NODE_ICON,rt as NO_RESULTS_TEXT,st as NoDataAlert,xa as NodeIcon,fa as NotificationsProvider,Pt as OneTimePasscodeForm,ba as PASSWD_REQS,ot as PLACEHOLDER_TEXT,E as PageWithTitle,ce as PasswordDialog,it as PersonalSearchList,nt as PrebuiltSearchList,Ne as RemoteContent,La as SAMLProviderTable,va as SAMLProviderTableActionMenu,lt as SearchCurrentNodes,ct as SearchResultItem,ya as SetupKeyDialog,I as TextWithFallback,Sa as UNKNOWN_ICON,Fe as UserProfile,de as UserTokenManagementDialog,A as apiClient,ja as calculateJobDuration,wa as collapseAllSections,dt as createSavedQuery,pt as deleteSavedQuery,ut as downloadFile,Ca as edgeInfoSlice,Aa as edgeSectionToggle,ka as edgeinfo,ht as exportToJson,mt as format,gt as formatADSpecificTime,xt as formatBoolean,ft as formatList,bt as formatNumber,vt as formatString,yt as getSavedQueries,we as getUsername,Pa as initialState,Da as passwordRegex,St as savedQueryKeys,Ta as setEdgeInfoOpen,Ea as setSelectedEdge,$a as testPassword,Tt as useAvailableDomains,jt as useCreateSavedQuery,wt as useDeleteSavedQuery,se as useNotifications,Ct as useOnClickOutside,At as useSavedQueries};
